<div class="profile-container" [formGroup]="registrationForm">
  <!-- Paso 1: Información Personal -->
  <div *ngIf="currentStep === 1" class="step-section">
    <h2>Información Personal</h2>



    <!-- Sección de Mapa y Ubicación -->
<div class="map-container">
  <!-- Contenedor del mapa con ID específico -->
  <div class="map-frame">
    <div id="map"></div>
  </div>

  <!-- Sección de información de ubicación (se mantiene igual) -->
<div class="location-info">
  <div class="form-group">
    <label>Radio de Cobertura (km):</label>
    <div class="range-container">
      <input type="range" 
             formControlName="coverageRadius" 
             min="1" 
             max="100" 
             step="1">
      <span>{{ registrationForm.get('coverageRadius')?.value }} km</span>
    </div>
    <div class="error-message" *ngIf="registrationForm.get('coverageRadius')?.invalid">
      Radio inválido (mínimo 1 km)
    </div>
  </div>
  
  <div class="coordinates" 
       *ngIf="registrationForm.get('latitude')?.value && registrationForm.get('longitude')?.value">
    <p>Ubicación seleccionada:</p>
    <p>Latitud: {{ registrationForm.get('latitude')?.value | number:'1.4-4' }}</p>
    <p>Longitud: {{ registrationForm.get('longitude')?.value | number:'1.4-4' }}</p>
    <div class="error-message" 
         *ngIf="registrationForm.get('latitude')?.errors || registrationForm.get('longitude')?.errors">
      Debe seleccionar una ubicación en el mapa
    </div>
  </div>
</div>

    <!-- Sección de Documentos -->
    <div class="document-section">
      <div class="form-group">
        <label>Nombre Completo:</label>
        <i class="fas fa-info-circle"></i>
        <input type="text" formControlName="fullName">
        <!-- Mensaje de error -->
      </div>

      <div class="form-row">
        <!-- DNI Frente y Dorso -->
        <div class="form-group">
          <label>DNI Frente:</label>
          <i class="fas fa-info-circle"></i>
          <input type="file" (change)="onFileSelected($event, 'dniFront')">
          <img *ngIf="dniFrontUrl" [src]="dniFrontUrl" class="preview-image">
        </div>

        <div class="form-group">
          <label>DNI Dorso:</label>
          <i class="fas fa-info-circle"></i>
          <input type="file" (change)="onFileSelected($event, 'dniBack')">
          <img *ngIf="dniBackUrl" [src]="dniBackUrl" class="preview-image">
        </div>
      </div>

      <!-- Selfie y Foto de Perfil -->
      <div class="form-row">
        <div class="form-group">
          <label>Selfie con DNI:</label>
          <i class="fas fa-info-circle"></i>
          <input type="file" (change)="onFileSelected($event, 'selfie')">
          <img *ngIf="selfieUrl" [src]="selfieUrl" class="preview-image">
        </div>

        <div class="form-group">
          <label>Foto de perfil:</label>
          <i class="fas fa-info-circle"></i>
          <input type="file" (change)="onFileSelected($event, 'profilePicture')">
          <img *ngIf="profilePictureUrl" [src]="profilePictureUrl" class="preview-image">
        </div>
      </div>
    </div>
  </div>
</div>

  <!-- Paso 2: Información Profesional -->
  <div *ngIf="currentStep === 2" class="step-section">
    <h2>Información Profesional</h2>

    <!-- Especializaciones -->
<div *ngFor="let subcategory of subcategories"> <!-- Usa subcategories -->
  <label>
    <input type="checkbox" 
           [value]="subcategory.id" 
           (change)="onSubcategoryChange($event, subcategory.id)">
    {{ subcategory.name }}
  </label>
</div>

    <!-- Experiencia Profesional -->
    <div class="form-group">
      <label>Profesión:</label>
      <i class="fas fa-info-circle" title="Ingrese su profesión u ocupación principal."></i>
      <input type="text" formControlName="profession">
      <div *ngIf="registrationForm.get('profession')?.invalid" class="error-message">
        Campo obligatorio
      </div>
    </div>

    <div class="form-group">
      <label>Años de Experiencia:</label>
      <i class="fas fa-info-circle" title="Ingrese el número de años de experiencia en su campo profesional."></i>
      <input type="number" formControlName="yearsOfExperience">
      <div *ngIf="registrationForm.get('yearsOfExperience')?.invalid" class="error-message">
        Valor mínimo: 0
      </div>
    </div>

    <!-- Descripción y Documentos -->
    <div class="form-group">
      <label>Descripción de Servicios:</label>
      <i class="fas fa-info-circle" title="Describa los servicios que ofrece y sus habilidades principales."></i>
      <textarea formControlName="skillsDescription" rows="4"></textarea>
      <div *ngIf="registrationForm.get('skillsDescription')?.invalid" class="error-message">
        Descripción requerida
      </div>
    </div>

    <div class="form-group">
      <label>Título Universitario:</label>
      <i class="fas fa-info-circle" title="Suba una imagen o PDF de su título universitario."></i>
      <input type="file" (change)="onFileSelected($event, 'universityTitle')" accept="image/*,.pdf" required>
      <div *ngIf="registrationForm.get('universityTitle')?.invalid" class="error-message">
        Documento requerido
      </div>
    </div>

    <div class="form-group">
      <label>Certificaciones Adicionales (máx. 3):</label>
      <i class="fas fa-info-circle" title="Suba hasta 3 imágenes o PDFs de otras certificaciones relevantes."></i>
      <input type="file" (change)="onFileSelected($event, 'certifications')" accept="image/*,.pdf" multiple>
    </div>

    <!-- Galería de Trabajos -->
    <div class="form-group">
      <label>Imágenes de trabajos anteriores:</label>
      <i class="fas fa-info-circle" title="Suba imágenes de trabajos anteriores que desee mostrar en su galería."></i>
      <input type="file" [multiple]="true" (change)="onFileSelected($event, 'galleryImages')" accept="image/*" multiple>
      <div class="gallery-preview">
        <img *ngFor="let img of galleryImageUrls" [src]="img" class="gallery-image">
      </div>
    </div>
  </div>

  <!-- Navegación y Mensajes -->
  <div class="navigation-buttons">
    <button *ngIf="currentStep > 1" 
            type="button" 
            class="btn-previous" 
            (click)="previousStep()">
      Anterior
    </button>
    
    <button *ngIf="currentStep < totalSteps"
            type="button"
            class="btn-next"
            (click)="nextStep()"
            [disabled]="!isStepValid(currentStep)">
      Siguiente
    </button>
    
    <button *ngIf="currentStep === totalSteps"
            type="button"
            class="btn-submit"
            (click)="saveProfile()"
            [disabled]="isLoading">
      {{ isLoading ? 'Guardando...' : 'Finalizar Registro' }}
    </button>
  </div>

  <div *ngIf="errorMessage" class="error-message">
    {{ errorMessage }}
  </div>
</div>