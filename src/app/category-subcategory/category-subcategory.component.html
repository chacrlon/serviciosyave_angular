
<div class="container">  
  <h2>Categor√≠as</h2>  
  <div class="service-form">  
    <ul>  
      <li *ngFor="let category of categories">  
        {{ category.name }}  
        <button (click)="editCategory(category)">Editar</button>  
        <button (click)="deleteCategory(category.id)">Eliminar</button>  

            <!-- Nuevo: Mostrar estructura del formulario -->
    <div *ngIf="category.formulario?.campos" class="formulario-container">
      <h4>Campos del formulario:</h4>
      <ul>
          <li *ngFor="let campo of category.formulario.campos">
              <strong>{{ campo.etiqueta }}</strong> ({{ campo.tipo }})
              - Requerido: {{ campo.requerido ? 'S√≠' : 'No' }}
          </li>
      </ul>
  </div>

         
        <ul *ngIf="category.subcategories && category.subcategories.length > 0">  
          <li *ngFor="let subcategory of category.subcategories">  
            {{ subcategory.name }}  
            <button (click)="editSubcategory(subcategory)">Editar</button>  
            <button (click)="deleteSubcategory(subcategory.id)">Eliminar</button>  
          </li>  
        </ul>  
      </li>  
    </ul>  

    <input [(ngModel)]="newCategory.name" placeholder="Nombre de nueva categor√≠a" />
    <div>
      <button (click)="agregarCampoNuevo()">Agregar Campo al Formulario</button>
      <div *ngIf="newCategory.formulario?.campos">
        <div *ngFor="let campo of newCategory.formulario.campos; index as i">
          <select [(ngModel)]="campo.tipo">
            <option value="text">Texto</option>
            <option value="number">N√∫mero</option>
            <option value="checkbox">Checkbox</option>
          </select>
          <input [(ngModel)]="campo.clave" placeholder="Clave (ID)">
          <input [(ngModel)]="campo.etiqueta" placeholder="Etiqueta">
          <label>
            <input type="checkbox" [(ngModel)]="campo.requerido"> Requerido
          </label>
          <button (click)="eliminarCampoNuevo(i)">Eliminar</button>
        </div>
      </div>
    </div>  
    <button (click)="addCategory()">Agregar Categor√≠a</button>  
  </div>  




  <div *ngIf="updateCategoryData" class="service-form">  
    <h3>Editar Categor√≠a</h3>  
    <input [(ngModel)]="updateCategoryData.name" placeholder="Editar nombre de categor√≠a" /> 
    
    <!-- Secci√≥n del formulario din√°mico -->
    <div class="dynamic-form-section">
      <h4>Campos del formulario:</h4>
      <button type="button" (click)="agregarCampo()">‚ûï Agregar Campo</button>
      
      <div *ngFor="let campo of updateCategoryData.formulario?.campos; index as i" class="campo-row">
          <select [(ngModel)]="campo.tipo" name="tipo-{{i}}">
              <option value="text">Texto</option>
              <option value="number">N√∫mero</option>
              <option value="checkbox">Checkbox</option>
          </select>
          
          <input [(ngModel)]="campo.clave" placeholder="Clave (ID)" name="clave-{{i}}">
          
          <input [(ngModel)]="campo.etiqueta" placeholder="Etiqueta" name="etiqueta-{{i}}">
          
          <label>
              <input type="checkbox" [(ngModel)]="campo.requerido"> Requerido
          </label>
          
          <button type="button" (click)="eliminarCampo(i)">üóëÔ∏è</button>
      </div>
  </div>
  
    <button (click)="updateCategory()">Actualizar Categor√≠a</button>  
  </div>  

  <h2>Subcategor√≠as</h2>  
  <div class="service-form">  
    <label for="categorySelect">Selecciona Categor√≠a:</label>  
    <select id="categorySelect" [(ngModel)]="selectedCategoryId">  
      <option value="" disabled>Selecciona una Categor√≠a</option>  
      <option *ngFor="let category of categories" [value]="category.id">{{ category.name }}</option>  
    </select>  

    <input [(ngModel)]="newSubcategory.name" placeholder="Nombre de nueva subcategor√≠a" />  
    <button (click)="addSubcategory()">Agregar Subcategor√≠a</button>  
  </div>  

  <div *ngIf="updateSubcategoryData" class="service-form">  
    <h3>Editar Subcategor√≠a</h3>  
    <input [(ngModel)]="updateSubcategoryData.name" placeholder="Editar nombre de subcategor√≠a" />  
    <button (click)="updateSubcategory()">Actualizar Subcategor√≠a</button>  
  </div>  

  <div *ngIf="errorMessage" class="notification">  
    {{ errorMessage }}  
  </div>  
</div>